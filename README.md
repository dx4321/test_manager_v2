**Test Manager README**

Это улучшенная версия Менеджера тестов для автоматизированного тестирования приложений. Программа предназначена для оптимизации процесса тестирования путем управления сборками, выполнения тестов на виртуальных машинах и создания подробных отчетов. Ниже приведен исчерпывающий обзор его функциональности и использования.

### **Начало работы**
1. **Установка:**
   - Склонируйте репозиторий: `git clone http://gitlab.bolid.ru/fishzon/vsphere_ranorex_test_manager`
   - Настройка виртуальной среды (Windows): (python -m venv venv) затем (venv\Scripts\activate)
   - Установите необходимые зависимости. `pip install requirements.txt`

2. **Конфигурация:**
   - Обновите файл конфигурации (`config.yaml`) необходимой информацией. (описание в `config_example.yaml`)
   - Убедитесь, что правильно указаны конечные точки API для TeamCity и VSphere.

3. **Зависимости:**
   - Убедитесь, что установлены все необходимые зависимости.
   - Версия Python: 3.x
   - Необходимые пакеты Python можно установить с помощью `pip install -r requirements.txt`.

### **Обзор рабочего процесса**
1. **Проверка сборки:**
   - При запуске программы проверяется, следует ли запускать ее немедленно или в соответствии с предварительным расписанием.
   - Проверяет последнюю сборку в TeamCity с использованием предоставленной конечной точки API.
   - Сравнивает номер сборки с тем, что указано в файле Excel.

2. **Конфигурация тестового набора:**
   - Создаются экземпляры `TestingPOStatus` для приложений с новыми сборками.
   - Определяет тестовые комплекты с конфигурациями YAML, указывающими тесты, виртуальные машины и стенды.

3. **Инициализация стендов и IP:**
   - Инициализирует стенды и IP-адреса на основе конфигурации.

4. **Создание очереди тестов:**
   - Создает очередь для последовательного выполнения тестов.

5. **Выполнение тестов:**
   - Тесты выполняются асинхронно, одна функция проверяет завершение, а другая инициирует тесты.
   - Асинхронно выделяет лицензии, запускает тесты и мониторит их завершение.

6. **Отчетность о результатах:**
   - Преобразует отчеты Ranorex в формат PDF.
   - Агрегирует отчеты в ZIP-архив.
   - Отправляет уведомления по электронной почте с результатами тестов указанным программам и пользователям.

7. **Выполнение тестового случая (Task_for_test):**
   - Методы внутри класса выполняют шаги, такие как подготовка ВМ, выполнение теста, создание снимка и завершение.

8. **Очистка:**
   - Автоматически удаляет оставшиеся клоны ВМ с использованием слова "clone" в их названиях.

### **Дополнительные детали**
1. **Логирование:**
   - Каждый тестовый случай создает свой собственный лог-файл.
   - Основная логика программы логируется в файл с именем `log_дата_сегодняшнего_дня.txt`.

2. **Виртуальные машины:**
   - Тесты запускаются на ВМ, размещенных на VSphere, с использованием VSphere API для взаимодействия.

3. **Выполнение тестов:**
   - Тесты запускаются через командную строку с использованием скомпилированных сборок Ranorex.

4. **Интеграция с TeamCity:**
   - Взаимодействует с TeamCity через TeamCity API.
   - Получает информацию о тестовых программах, включая последние версии и даты выпуска.

5. **Загрузка дистрибутивов:**
   - Дистрибутивы программ загружаются в сетевую папку, доступную программе.

### **Советы по использованию**
- Обеспечьте точную настройку в файле `config.yaml`.
- Регулярно проверяйте и обновляйте зависимости.
- Следите за электронной почтой для уведомлений о результатах тестов.

Конфигурация программы является прямым отражением ее работы. Особенно важна конфигурация, отвечающая за построение цепочек тестов. Вот пример конфигурации с некоторыми деталями:
ProgramsForTests:
  #### ORION_PRO ######
  - name: orion_pro
    tests_are_active: true
    last_build: inTeamCityGetInModule
    snapshot_name: Все готово к автотестам

    kits:
      - kit_name: win_preparation_1
        tests_are_active: true
        path_to_test_install_check_license: \\192.168.202.33\smb\Автотестирование\OrionPro\Скачивание установка\ADB_06_2022.exe
        vms:
          - Fishzone_Win10x64
        stands:
          - stand_name: s10_1
            path_to_test: \\192.168.202.33\smb\Автотестирование\OrionPro\Тесты на вин 10_1\ADB_06_2022.exe
          - stand_name: s10_2
            path_to_test: \\192.168.202.33\smb\Автотестирование\OrionPro\Тесты на вин 10_2\ADB_06_2022.exe

      - kit_name: win_preparation_2
        tests_are_active: true
        path_to_test_install_check_license: \\192.168.202.33\smb\Автотестирование\OrionPro\Скачивание установка\ADB_06_2022.exe
        vms:
          - Fishzone_Win11x64
          - Fishzone_Win2022
          - Fishzone_Win7x64
          - Fishzone_Win8.1x64
          - Fishzone_Win2012r2
          - Fishzone_Win2016
          - Fishzone_Win2019
          - Fishzone_win2012
        stands:
          - stand_name: use_os
            path_to_test: \\192.168.202.33\smb\Автотестирование\OrionPro\тесты на все ОС\ADB_06_2022.exe